(self.miniJsonp=self.miniJsonp||[]).push([[4997],{78232:function(e,r,t){var o;o=(e,r,t,o,n)=>(()=>{"use strict";var s={383:r=>{r.exports=e},975:e=>{e.exports=r},511:e=>{e.exports=t},644:e=>{e.exports=o},855:e=>{e.exports=n}},c={};function a(e){var r=c[e];if(void 0!==r)return r.exports;var t=c[e]={exports:{}};return s[e](t,t.exports,a),t.exports}a.d=(e,r)=>{for(var t in r)a.o(r,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.r(i),a.d(i,{allConversationIdsSelector:()=>c,conversationBeenDeletedSelector:()=>J,conversationDirectionSelector:()=>f,conversationHttpStatusSelector:()=>g,conversationIdsSelector:()=>n,conversationLastMessageSelector:()=>Pe,conversationsSelector:()=>m,curConvsMessageSelector:()=>Be,curMessagesRelatedSelector:()=>Ie,currentBuyerIdSelector:()=>I,currentBuyerSelector:()=>B,currentBuyerShopIdSelector:()=>N,currentBuyerShopSelector:()=>U,currentConversationBuyerIdSelectors:()=>j,currentConversationCanReadSelector:()=>p,currentConversationHasLoadingSelector:()=>le,currentConversationIdSelector:()=>S,currentConversationMaxOptionHideTimeSelectors:()=>L,currentConversationSelector:()=>E,currentConversationShopIdSelectors:()=>A,currentConversationShopRegionSelectors:()=>P,currentConversationShopSelectors:()=>T,currentConversationStatusSelectors:()=>w,currentConversationToNameSelector:()=>K,currentConversationTranslationAccessSelector:()=>H,currentPendingOffersCountSelector:()=>$,currentSellerAccountIdSelector:()=>te,currentShopIdSelector:()=>x,degradeConversationIdsSelector:()=>y,feedbackSelector:()=>Fe,filterSelector:()=>M,filteredConversationsSelector:()=>O,getConversation:()=>z,getConversationPendingOffersCountSelector:()=>ee,getConversationShopId:()=>D,getConversationShopRegion:()=>re,getConversations:()=>k,getConvsMessagesRelatedSelector:()=>Te,getMessageSelector:()=>Ee,inlocationSelector:()=>d,isNavigateToUnreadMessageSelector:()=>W,keywordSelector:()=>G,listsHashSelector:()=>Y,mediaListSelector:()=>Ve,messagesRelatedMapSelector:()=>ye,missedReadNoticeCountSelector:()=>u,navigateToUnreadMessageIdSelector:()=>X,noticesCountSelector:()=>Ye,pinnedConversationIdsSelector:()=>s,readRequestIdsSelector:()=>l,reconnectFlagSelector:()=>He,replyToMessageSelector:()=>Ge,resultsSelector:()=>V,reverseMessagesSelector:()=>ze,searchConversationHttpStatusSelector:()=>F,selectVideoInfoByKey:()=>Oe,selectVideoInfoKeyByVid:()=>be,shopAccessSelector:()=>Q,showFrozenTipSelector:()=>ae,showLoadingMessagesMapSelector:()=>ie,singleConversationMarkInfoSelector:()=>ce,sortedConversationsSelector:()=>b,totalConversationsCountSelector:()=>ne,updateTimeNowSelector:()=>v});var e=a(383),r=a(975),t=a(511),o=a(644),n=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationIds)||[]},s=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pinnedConversationIds)||[]},c=(0,r.createSelector)(n,s,((e,r)=>{var t=e.filter((e=>!r.includes(e)));return r.concat(t)})),l=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.readRequestIds)||[]},u=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.missedReadNoticeCount)||0},d=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.inlocation)||!1},v=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.updateTimeNow)||"0"},S=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationId)||null},p=e=>{var r;return(0,t.judgeUndefined)({defaultValue:!0,value:null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationCanRead})},g=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.status)||""},f=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.direction)||""},m=(0,r.createSelector)(t.conversationEntitiesSelector,c,((r,t)=>((0,e.denormalize)(t,[o.conversationSchema],{conversations:r})||[]).filter(Boolean))),h=(0,r.createSelector)(m,S,((e,r)=>e.filter((e=>{var{id:t,unread_count:o}=e;return e&&(o>0||t===r)})))),_=(0,r.createSelector)(m,(e=>e.filter((e=>e.isPinned)))),C=(0,r.createSelector)(m,(e=>e.filter((e=>e.status&&"closed"===e.status)))),R=(0,r.createSelector)(m,S,((e,r)=>e.filter((e=>{var{unreplied:t,id:o}=e;return void 0===t||t||!t&&o===r})))),y=(0,r.createSelector)(m,(e=>e.filter((e=>e.lack)).map((e=>e.id))||[])),M=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.filter)||"All"},O=(0,r.createSelector)(M,m,h,_,C,R,((e,r,t,o,n,s)=>({All:r,Unread:t,Pinned:o,Closed:n,Unreplied:s}[e]))),b=(0,r.createSelector)(O,s,t.waitingTimeFilterSelector,M,((e,r,t,o)=>{var n=e.filter((e=>!r.includes(e.id))),s=e.filter((e=>r.includes(e.id)));return n.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))),s.concat(n).filter((e=>void 0===e.faking))})),E=(0,r.createSelector)(m,S,t.isSubAccountSelector,d,t.userEntitiesSelector,t.conversationEntitiesSelector,((r,t,n,s,c,a)=>{var i=r.find((e=>e.id===t))||{};if(s&&!i.id&&(i=(0,e.denormalize)(t,o.conversationSchema,{conversations:a})||{}),!n&&i.lack){var l=i.to_id,u=(0,e.denormalize)(l,o.userSchema,{users:c})||{},d={to_shop_id:u.shop_id,to_status:u.status,to_name:u.name||"-",to_avatar:u.avatar};return Object.assign(i,d)}return i})),I=(0,r.createSelector)(E,(e=>{var{to_id:r}=e||{};return r||null})),T=(0,r.createSelector)(E,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r.shop_id,o.shopSchema,{shops:t})||{})),P=(0,r.createSelector)(T,(e=>(null==e?void 0:e.country)||"SG")),A=(0,r.createSelector)(E,(e=>e.shop_id)),j=(0,r.createSelector)(E,(e=>e.to_id)),w=(0,r.createSelector)(E,(e=>e.status)),L=(0,r.createSelector)(E,(e=>e.max_general_option_hide_time)),z=n=>(0,r.createSelector)(t.conversationEntitiesSelector,(r=>(0,e.denormalize)(n,o.conversationSchema,{conversations:r})||{})),D=e=>(0,r.createSelector)(z(e),(e=>e.shop_id)),k=e=>(0,r.createSelector)(m,(r=>e.map((e=>r.find((r=>r.id===e)))).filter(Boolean))),x=(0,r.createSelector)(E,(e=>{var{shop_id:r}=e||{};return r||null})),B=(0,r.createSelector)(t.userEntitiesSelector,E,((r,t)=>t?(0,e.denormalize)(t.to_id,o.userSchema,{users:r}):{})),N=(0,r.createSelector)(E,(e=>{var{to_shop_id:r}=e||{};return r||null})),U=(0,r.createSelector)(N,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.shopSchema,{shops:t})||{})),G=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.keyword)||""},V=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.results)||[]},F=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.searchStatus)||""},H=(0,r.createSelector)(E,(e=>e.translationAccess)),Y=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.listsHash)||{}},J=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationBeenDeleted)||!1},K=(0,r.createSelector)(E,(e=>{var{to_name:r}=e||{};return r})),q={hasSCAccess:!0,hasEditOrderAccess:!0,hasViewOrderAccess:!0,hasViewProductAccess:!0,hasEditVoucherAccess:!0,hasViewVoucherAccess:!0,hasViewRrOrderAccess:!0,hasOrderDetailAccess:!0},Q=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.access)||q},W=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.isNavigateToUnreadMessage)||!1},X=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.navigateToUnreadMessageId)||""},Z=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pendingOffersCount)||{}},$=(0,r.createSelector)(E,Z,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),ee=e=>(0,r.createSelector)(z(e),Z,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),re=n=>(0,r.createSelector)(D(n),t.shopsEntitiesSelector,((r,t)=>{var n=(0,e.denormalize)(r,o.shopSchema,{shops:t})||{};return(null==n?void 0:n.country)||"SG"})),te=(0,r.createSelector)(t.isSubAccountSelector,t.currentUserIdSelector,T,((e,r,t)=>e?t.user_id:r)),oe={unrepliedCount:0,duesoonCount:0,overdueCount:0,pinnedCount:0,unreadCount:0},ne=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.totalConversationsCount)||oe},se=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationMark)||{}},ce=e=>(0,r.createSelector)(se,(r=>r[e])),ae=(0,r.createSelector)(t.shopTranslationSettingsSelector,t.isSubAccountSelector,x,t.currentUserShopIdSelector,((e,r,t,o)=>{var n=r?t:o,{userStatus:s}=e[n]||{};return"frozen"===s})),ie=e=>{var r;return null===(r=e.conversationReducer)||void 0===r?void 0:r.showLoadingMessagesMap},le=(0,r.createSelector)(S,ie,((e,r)=>{var t=r&&r[e];return(Object.entries(t||{})||[]).some((([e,r])=>null==r?void 0:r.showLoading))}));function ue(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var de=a(855);function ve(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function Se(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ve(Object(t),!0).forEach((function(r){ue(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var pe,{MSG_TYPE_OFFER:ge,MSG_TYPE_ORDER:fe,MSG_TYPE_PRODUCT:me,MSG_TYPE_FAQ_UNSUPPORTED:he,MSG_TYPE_FAQ_LIVEAGENT_PROMPT:_e,MSG_TYPE_RATE_CARD:Ce}=de.MessageTypes,Re=[fe,me],ye=(0,r.createSelector)((e=>e),(e=>(e.messageReducer||{}).messagesRelatedMap||{})),Me=e=>{var r;return(null===(r=e.messageReducer)||void 0===r?void 0:r.videoMap)||{}},Oe=e=>(0,r.createSelector)(Me,(r=>JSON.parse(JSON.stringify(r[e]||{})))),be=e=>(0,r.createSelector)(Me,(r=>Object.keys(r).find((t=>r[t].vid===e)))),Ee=n=>(0,r.createSelector)(t.messageEntitiesSelector,(r=>(0,e.denormalize)(n,o.messageSchema,{messages:r}))),Ie=(0,r.createSelector)(S,ye,((e,r)=>r[e]||{all:[]})),Te=e=>(0,r.createSelector)(ye,(r=>r[e]||{all:[],sending:[],failed:[]})),Pe=(pe=e=>(0,r.createSelector)(Te(e),z(e),t.messageEntitiesSelector,((e,r,o)=>(0,t.getConversationLastMessage)(e,r,o))),function(){var e=Array.prototype.slice.call(arguments);return e in(pe.memoize=pe.memoize||{})?pe.memoize[e]:pe.memoize[e]=pe.apply(this,e)}),Ae=(0,r.createSelector)(Ie,(e=>{var r=[...e.all||[]];return e.securityTipsMessageId&&r.push(e.securityTipsMessageId),r})),je=(0,r.createSelector)(Ie,(e=>e.sending||[])),we=(0,r.createSelector)(Ie,(e=>e.failed||[])),Le=(0,r.createSelector)(t.messageEntitiesSelector,Ae,((r,t)=>((0,e.denormalize)(t,[o.messageSchema],{messages:r})||[]).filter(Boolean))),ze=(0,r.createSelector)(Le,(e=>e.reverse())),De=(0,r.createSelector)(E,ze,((e,r)=>e?r.filter(Boolean).reduce(((e,r)=>{var{type:t,source_type:o,source_content:n,content:s}=r;if(!o||t===ge||[-1,0].includes(n["".concat(o,"_id")]))return e;if(Re.includes(t)&&n){var c="".concat(t,"_id");if(s[c]===n[c])return e}var{lastSourceMessage:a,sourceList:i}=e;if(!i.length)return{sourceList:i.concat(r),lastSourceMessage:r};if(o===me){var l=null==n?void 0:n.product_id,u=a.source_content&&a.source_content.product_id;if(!l||u===l)return e}else if(o===fe){var d=null==n?void 0:n.order_id,v=a.source_content&&a.source_content.order_id;if(!d||[-1,0,v].includes(d))return e}return{sourceList:i.concat(r),lastSourceMessage:r}}),{sourceList:[],lastSourceMessage:null}).sourceList:[])),ke=(0,r.createSelector)(De,(e=>e.map((e=>e.id)))),xe=(0,r.createSelector)(t.entitiesSelector,Le,((r,t)=>{var n=t.filter((e=>e&&e.type===ge)).map((e=>e.content.offer_id));return(0,e.denormalize)(n,[o.offerSchema],r)})),Be=(0,r.createSelector)(ze,ke,je,we,E,t.rateCardEntitiesSelector,xe,((e,r,t,o,n,s,c)=>n?e.filter((e=>{if(!e)return!1;var{content:r,type:t}=e;return!(![he,_e].includes(t)&&(!r||r&&0===Object.keys(r).length))})).map((e=>{var n=t.includes(e.id)?de.MessageSendStatus.SENDING:o.includes(e.id)?de.MessageSendStatus.FAILED:e.send_status?de.MessageSendStatus.SUCCEED:null,a=r.includes(e.id),i=Object.assign({},e,{send_status:n,hasMessageSource:a}),{type:l,content:u={},message_option:d}=i;switch(l){case ge:var v=c.find((e=>e&&e.id===u.offer_id));i=Object.assign({},i,{textContent:v});break;case Ce:var S=s[u.card_id];S&&(i=Object.assign({},i,{textContent:S}))}return(0,de.hasTargetMessageOption)(d,de.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(i=Se(Se({},i),{},{send_status:de.MessageSendStatus.FAILED,errorCode:de.MessageErrorCode.BLACKLIST})),i})):[])),Ne=(0,r.createSelector)((e=>{var r;return null==e||null===(r=e.messageReducer)||void 0===r?void 0:r.reply}),(e=>e?e.toMessageId:{})),Ue=(0,r.createSelector)(S,Ne,((e,r)=>r[e]||"")),Ge=(0,r.createSelector)(Ue,t.messageEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.messageSchema,{messages:t}))),Ve=(0,r.createSelector)(S,(e=>{var r;return(null===(r=e.mediaPreviewerReducer)||void 0===r?void 0:r.mediaMap)||{}}),((e,r)=>r[e]||[])),Fe=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.feedback)||void 0},He=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.reconnectFlag)||!1},Ye=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.noticesCount)||0}})(),i})(),e.exports=o(t(82677),t(20573),t(53402),t(96961),t(29494))},66633:function(e,r,t){"use strict";e.exports=t(78232)}}]);