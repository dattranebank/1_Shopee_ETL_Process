(self.miniJsonp=self.miniJsonp||[]).push([[8592],{25061:function(e,t,r){var o,a,s,n,c,i,l,u,d,S,p;e.exports=(o=r(34857),a=r(20573),s=r(29494),n=r(96961),c=r(6678),i=r(82677),l=r(38104),u=r(58518),d=r(44900),S=r(67429),p=r(36808),(()=>{"use strict";var e={701:(e,t,r)=>{r.d(t,{t:()=>s});var o=r(661),a=r.n(o),s=a().t.bind(a())},661:e=>{e.exports=u},598:e=>{e.exports=p},383:e=>{e.exports=i},252:e=>{e.exports=c},944:e=>{e.exports=o},975:e=>{e.exports=a},783:e=>{e.exports=l},644:e=>{e.exports=n},855:e=>{e.exports=s},672:e=>{e.exports=d},459:e=>{e.exports=S}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var _={};return(()=>{r.r(_),r.d(_,{addNeedCaptchaRequest:()=>Uo,agentConversationEntitiesSelector:()=>i,allMessageShortcutGroupsSelector:()=>Ur,authorizedShopsCountSelector:()=>Pe,autoTranslation:()=>xr,batchRemoveDraftHandler:()=>ze,batchUpdateRecord:()=>I,buyerIsFrozenSelector:()=>Ge,captchaSignatureSelector:()=>ce,captchaVerifyReducer:()=>Mo,captchaVisibleSelector:()=>ne,chatbotToggleSelector:()=>te,checkUserPermissionSaga:()=>Xt,checkUserPermissionSucceeded:()=>zt,clearNeedCaptchaRequest:()=>No,clearReportRequested:()=>go,contactsEntitiesSelector:()=>g,conversationEntitiesSelector:()=>c,conversationsLengthLevelSelector:()=>h,copySucceedFeedback:()=>Er,curTabFocusedSelector:()=>Ae,currentAllMessageShortcutsSelector:()=>Mr,currentGroupIdSelector:()=>Pr,currentGroupTypeSelector:()=>Rr,currentMessageShortcutGroupsSelector:()=>Ir,currentUserDistributionStatusSelector:()=>fe,currentUserIdSelector:()=>q,currentUserIsSellerSelector:()=>we,currentUserRoleSelector:()=>he,currentUserSelector:()=>de,currentUserShopIdSelector:()=>Te,currentUserShopSelector:()=>ge,deleteCaptchaRequest:()=>wo,deleteConfigDurationSelector:()=>X,deleteConfigSelector:()=>ae,deleteConversationSucceedHandler:()=>Qe,deleteRecord:()=>N,disappearChatbotLoadingTimeSelector:()=>oe,displayCBCBannerSelector:()=>Kr,distributionAccountStatusSelector:()=>Br,draftHashSelector:()=>so,entitiesSelector:()=>s,entityReducer:()=>F,fetchSettings:()=>zr,fetchSettingsStatusSelector:()=>io,fetchShopAuth:()=>ur,fetchShopsByIds:()=>lr,fetchedShopIdsSelector:()=>nr,forceLogoutRequested:()=>Pt,forwardGroupMembersSelector:()=>A,forwardGroupsEntitiesSelector:()=>v,getConversationLastMessage:()=>lt,getDraft:()=>no,getShopUnreadCountByIds:()=>cr,getTimestamp:()=>ot,getToastInformation:()=>_r,handle401ErrorRequested:()=>Zr,handleLoginSucceededLogic:()=>jt,handleMessageSubscribe:()=>Xe,hasDeletePermissionSelector:()=>J,hasFetchedUnreadSelector:()=>Re,hasReplyPermissionSelector:()=>Y,hasVerifyPhoneNumberNormalSellerSelector:()=>Ne,hasVerifyPhoneNumberSelector:()=>je,hasVerifyPhoneNumberSubaccountSelector:()=>Ie,hasVideoPermissionSelector:()=>z,hideFeedbackSelector:()=>ee,isCBSellerSelector:()=>_e,isMainPageSelector:()=>ve,isSubAccountSelector:()=>pe,judgeUndefined:()=>at,legacyMessageShortcutsCountSelector:()=>qr,loadingSelector:()=>Q,localeSelector:()=>Se,login:()=>Lt,loginRequested:()=>Ct,loginSucceeded:()=>bt,loginSuccessSelector:()=>be,logout:()=>er,logoutHandler:()=>$t,logoutRequested:()=>mt,logoutSucceeded:()=>Rt,messageEntitiesSelector:()=>l,messageShortcutGroupEntitiesSelector:()=>E,messageShortcutGroupHttpStatusSelector:()=>mr,messageShortcutGroupSelector:()=>br,messageShortcutsSelector:()=>kr,messageShortcutsStatusSelector:()=>Qr,messagesLengthLevelSelector:()=>f,networkStatusSelector:()=>K,newMessageFlagSelector:()=>le,newbieSelector:()=>B,notificationTypes:()=>ut,offerSelector:()=>oo,offersSelector:()=>to,openMallUrl:()=>Yr,openMallUrlSaga:()=>Xr,orderEntitiesSelector:()=>d,personalMessageShortcutGroupsSelector:()=>wr,personalMessageShortcutsSelector:()=>jr,productEntitiesSelector:()=>S,productsSelector:()=>Eo,pureActionHandler:()=>et,pureMergeActionHandler:()=>tt,rateCardEntitiesSelector:()=>O,reduxReset:()=>ao,relatedOfferIdsSelector:()=>ro,removeSingleDraftHandler:()=>Ke,reportArraySelector:()=>Oo,reportMessageApiTimer:()=>st,reportReducer:()=>bo,reportRequested:()=>To,resendMessagePayloadSelector:()=>ie,resendNeedCaptchaRequest:()=>Io,saveDraftHandler:()=>Ye,serviceDownAlertSelector:()=>Me,serviceDownClosedSelector:()=>He,serviceDownListSelector:()=>ke,serviceDownMessageSelector:()=>Fe,setServiceDownStatus:()=>Qt,setToastInformation:()=>Or,setToastInformationSaga:()=>gr,settingsFetchStatusSelector:()=>Wr,settingsNeedForceUpdateSelectors:()=>Gr,settingsSelector:()=>Fr,settingsStatusSelector:()=>Vr,shopSelector:()=>sr,shopStatisticsMapSelector:()=>Ee,shopStatisticsSelector:()=>Oe,shopTranslationSettingsSelector:()=>co,shopsEntitiesSelector:()=>T,shopsUnreadConversationCountSelector:()=>G,showAutoHangupModalSelector:()=>Ue,showChatWindowSelector:()=>Ce,showChatbotLoadingTimeSelector:()=>re,showConversationDetailSelector:()=>De,showCrrDueSelector:()=>$,showEntrySelector:()=>me,showShop:()=>ir,sortConversations:()=>rt,sortedAllMessageShortcutsSelector:()=>Hr,stickerEntitiesSelector:()=>u,subaccountHasUnrepliedPermissionSelector:()=>se,takeEveryWithCancel:()=>Fo,teamMessageShortcutGroupsSelector:()=>Nr,teamMessageShortcutsSelector:()=>Lr,textBoxHeightSelector:()=>ye,timerHandler:()=>vo,toastReducer:()=>Cr,toastSelector:()=>Sr,totalUnreadConversationsCountSelector:()=>V,unreadCountActions:()=>W,updateChatEntryStatus:()=>Ot,updateChatWindowStatus:()=>pt,updateConversationDetailStatus:()=>_t,updateConversationListsHash:()=>$r,updateCurTabFocused:()=>Ft,updateCurTabFocusedSaga:()=>Vt,updateCurTabFocusedSucceeded:()=>Gt,updateEntities:()=>U,updateHasFetchedUnread:()=>Tt,updateIsMainPage:()=>kt,updateLoginSuccessStatus:()=>Et,updateNetworkStatus:()=>dt,updateOrReplaceAction:()=>po,updateRecord:()=>w,updateShowAutoHangupModal:()=>St,updateStatusSelector:()=>lo,userEntitiesSelector:()=>n,userReducer:()=>ar,userSelector:()=>ue,verifyRequestsSelector:()=>ko,voucherEntitiesSelector:()=>p,waitingTimeFilterSelector:()=>Z,watchHandleUrlSagas:()=>eo,watchLogin:()=>Mt,watchReportSagas:()=>Co,watchTab:()=>Wt,watchToastSagas:()=>Dr,watchUserSagas:()=>or,watchVerifySagas:()=>Ho});var e=r(944),t=r(975),o=r(855),a=e=>e<=100?1:e<=500?2:e<=1e3?3:4,s=e=>e.entityReducer,n=(0,t.createSelector)(s,(e=>e.users)),c=(0,t.createSelector)(s,(e=>e.conversations)),i=(0,t.createSelector)(s,(e=>e.agentConversations)),l=(0,t.createSelector)(s,(e=>(e=>(0,o.checkEmptyObject)(e)?{}:e)(e.messages))),u=(0,t.createSelector)(s,(e=>e.stickers)),d=(0,t.createSelector)(s,(e=>e.orders)),S=(0,t.createSelector)(s,(e=>e.products)),p=(0,t.createSelector)(s,(e=>e.vouchers)),E=(0,t.createSelector)(s,(e=>e.messageShortcutsGroups)),O=(0,t.createSelector)(s,(e=>e.rateCards)),T=(0,t.createSelector)(s,(e=>e.shops)),g=(0,t.createSelector)(s,(e=>e.contacts)),h=(0,t.createSelector)(c,i,((e,t)=>{var r=Object.keys(e).length+Object.keys(t).length;return a(r)})),f=(0,t.createSelector)(l,(e=>a(Object.keys(e).length))),v=(0,t.createSelector)(s,(e=>e.groups)),A=(0,t.createSelector)(s,(e=>e.groupMembers));function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D,C=r(644);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.UPDATE_ENTITIES="UPDATE_ENTITIES",e.UPDATE_RECORD="UPDATE_RECORD",e.DELETE_RECORD="DELETE_RECORD",e.BATCH_UPDATE_RECORD="BATCH_UPDATE_RECORD"}(D||(D={}));const R={[D.UPDATE_ENTITIES]:(e,{payload:{entities:t}})=>Object.entries(t).reduce(((e,[t,r])=>"persist"!==t?("shops"===t&&C.shopService.updateShopMap(r),m(m({},e),{},{[t]:m(m({},e[t]),r)})):m(m({},e),{},{[t]:r})),e)};var P=r(252),{updateEntities:U,updateRecord:w,deleteRecord:N,batchUpdateRecord:I}=(0,P.createActions)({[D.UPDATE_ENTITIES]:({entities:e})=>({entities:e}),[D.UPDATE_RECORD]:({name:e,id:t,record:r})=>({name:e,id:t,record:r}),[D.DELETE_RECORD]:({name:e,id:t})=>({name:e,id:t}),[D.BATCH_UPDATE_RECORD]:({name:e,records:t,checkProp:r})=>({name:e,records:t,checkProp:r})});function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const M={[D.UPDATE_RECORD]:(e,{payload:{name:t,id:r,record:o}})=>L(L({},e),{},{[t]:L(L({},e[t]),{},{[r]:L(L({},e[t][r]),o)})}),[D.DELETE_RECORD]:(e,{payload:{name:t,id:r}})=>{var o=e[t];return delete o[r],L(L({},e),{},{[t]:o})},[D.BATCH_UPDATE_RECORD]:(e,{payload:{name:t,records:r,checkProp:o}})=>{var a=L({},e[t]);return Object.keys(r).forEach((e=>{(!o||o&&r[e][o]>a[e][o])&&(a[e]=L(L({},a[e]),r[e]))})),L(L({},e),{},{[t]:a})}};function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=(0,P.handleActions)(k(k({},R),M),{users:{},messages:{},conversations:{},agentConversations:{},stickers:{},orders:{},offers:{},products:{},shops:{},rateCards:{},persist:null,vouchers:{},messageShortcuts:{}}),G=e=>{var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.shopsUnreadConversationCount)||0},V=e=>{var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.totalUnreadConversationsCount)||0},W={MARK_AS_READ:"markAsRead",MARK_AS_UNREAD:"markASUnread",CLOSE_CONVERSATION:"closeConversation",DELETE_CONVERSATION:"deleteConversation",FORWARD_CONVERSATION:"forwardConversation",RECEIVE_UNREADABLE_MESSAGE:"receiveUnreadableMessage",REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT:"refreshTotalUnreadConversationCount",REFRESH_SHOPS_UNREAD_CONVERSATIONS_COUNT:"refreshShopsUnreadConversationsCount",REFRESH_SINGLE_SHOP_UNREAD_CONVERSATION_COUNT:"refreshSingleShopUnreadConversationCount",UPDATE_CONVERSATION:"updateConversation",MESSAGE_QUEUE_UPDATE:"messageQueueUpdate",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_CLOSE:"mass_close",ACTIVE_CONVERSATION:"activeConversation",CLEAR_CONVERSATION_COUNT:"clearConversationCount"},x=r(383),Q=e=>e.userReducer.loading,q=e=>e.userReducer.currentUserId,B=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.newbie)||[]},K=e=>e.userReducer.networkStatus,z=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasVideoPermission)||!1},Y=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasReplyPermission)||!1},J=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hasDeletePermission)||!1},X=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.deleteConfigDuration)||0},Z=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.waitingTimeFilter)||!1},$=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showCrrDue)||!1},ee=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.hideFeedback)||!1},te=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.chatbotToggle)||0},re=e=>{var t;return null==e||null===(t=e.userReducer)||void 0===t?void 0:t.showChatbotLoadingTime},oe=e=>{var t;return null==e||null===(t=e.userReducer)||void 0===t?void 0:t.disappearChatbotLoadingTime},ae=e=>{var{hasDeletePermission:t=!1,deleteConfigVersion:r=0,deleteConfigDuration:o=0}=(null==e?void 0:e.userReducer)||{};return{hasDeletePermission:t,deleteConfigVersion:r,deleteConfigDuration:o}},se=e=>e.userReducer.subaccountHasUnrepliedPermission,ne=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.captchaVisible)||!1},ce=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.captchaSignature)||""},ie=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.resendMessagePayload)||void 0},le=e=>e.userReducer.newMessageFlag,ue=e=>(0,t.createSelector)(s,(t=>(0,x.denormalize)(e,C.userSchema,{users:t}))),de=(0,t.createSelector)(n,q,((e,t)=>(0,x.denormalize)(t,C.userSchema,{users:e})||{})),Se=(0,t.createSelector)(de,(e=>e&&e.locale)),pe=(0,t.createSelector)(de,(e=>!(0,o.checkEmptyObject)(e)&&e.type===o.AccountType.SUBACCOUNT)),_e=(0,t.createSelector)(de,(e=>!(0,o.checkEmptyObject)(e)&&e.is_cb)),Ee=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.shopStatisticsMap)||{}},Oe=(e,r)=>(0,t.createSelector)(Ee,(t=>t["".concat(e,"-").concat(r)]||{})),Te=(0,t.createSelector)(de,pe,((e={},t)=>t?void 0:e.shop_id)),ge=(0,t.createSelector)(de,pe,T,((e={},t,r)=>t?void 0:(0,x.denormalize)(e.shop_id,C.shopSchema,{shops:r})||{})),he=(0,t.createSelector)(de,((e={})=>e.role||"")),fe=(0,t.createSelector)(de,(e=>e&&e.distribution_status||"")),ve=e=>e.userReducer.isMainPage,Ae=e=>e.userReducer.curTabFocused,ye=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.textBoxHeight)||0},De=e=>e.userReducer.showConversationDetail,Ce=e=>e.userReducer.showChatWindow,be=e=>e.userReducer.loginSuccess,me=e=>e.userReducer.showEntry,Re=e=>e.userReducer.hasFetchedUnread,Pe=(0,t.createSelector)(de,((e={})=>e.authorizedShopsCount||0)),Ue=e=>e.userReducer.showAutoHangupModal,we=(0,t.createSelector)(de,pe,((e={},t)=>!!t||e.is_seller)),Ne=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.hasVerifyPhoneNumber)||!1},Ie=e=>{var t;return(null==e||null===(t=e.userRelatedReducer)||void 0===t?void 0:t.hasVerifyPhoneNumberMap)||{}},je=(0,t.createSelector)(pe,Ne,Ie,((e,t,r)=>e?r:t)),Le=e=>{var t;return(null==e||null===(t=e.userReducer)||void 0===t?void 0:t.serviceDownStatus)||{}},Me=(0,t.createSelector)(Le,(e=>e.alert||!1)),He=(0,t.createSelector)(Le,(e=>e.closed||!1)),ke=(0,t.createSelector)(Le,(e=>e.list||!1)),Fe=(0,t.createSelector)(Le,(e=>e.message||!1)),Ge=(e,r,o)=>(0,t.createSelector)(Oe(e,r),(e=>"frozen"===o&&"boolean"==typeof e.exist_pending_order&&!e.exist_pending_order));function Ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var xe=(e,t)=>{var r=new Set(t);return r.delete(e),Array.from(r)},Qe=(e,{payload:{conversationId:t}})=>{var r=We(We({},e.conversationIdsMap),{},{[t]:!1}),o=xe(t,e.conversationIds),a=xe(t,e.pinnedConversationIds),{currentConversationId:s}=e;return We(We({},e),{},{currentConversationId:s===t?null:s,conversationIds:o,pinnedConversationIds:a,conversationIdsMap:r})};function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ke=(e,{payload:{conversationId:t}})=>{var r=Be({},e.draftHash);return delete r[t],Be(Be({},e),{},{draftHash:r})},ze=(e,{payload:{conversationIds:t=[]}})=>{var r=Be({},e.draftHash);return t.forEach((e=>{delete r[e]})),Be(Be({},e),{},{draftHash:r})},Ye=(e,{payload:{conversationId:t,draft:r}})=>{var o=Be({},e.draftHash);return o[t]=r,Be(Be({},e),{},{draftHash:o})},Je=r(783);function*Xe(t){var{payload:r,type:a}=t;yield(0,e.spawn)(st,r.request_id),a===o.ConversationTypeEnum.Agent?yield(0,e.put)((0,Je.receiveAgentMessageRequested)({message:r})):yield(0,e.put)((0,Je.receiveMessageRequested)({message:r}))}function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var et=()=>(e,{payload:t})=>$e($e({},e),t),tt=e=>(t,{payload:r})=>$e($e({},t),{},{[e]:$e($e({},t[e]),r)}),rt=e=>{e.sort(((e,t)=>parseInt(t.latest_message_id)-parseInt(e.latest_message_id)))},ot=(e,t)=>{var{last_message_time_nano:r,next_timestamp_nano:o}=e;return t&&!o&&(o=t.next_message_time_nano),{nextTimestampNano:o,oldestTimestampNano:o,latestTimestampNano:r}},at=({defaultValue:e,value:t})=>void 0===t?e:t;function*st(e){var t=yield(0,o.getItem)(e);if(t){var r=+new Date-+t;(0,C.collectAsyncTask)(C.ReportPoint.MESSAGE_SOCKET,r),(0,o.removeItem)(e)}}var nt,ct=r(701).t,{MSG_TYPE_TEXT:it}=o.MessageTypes,lt=(e,t,r)=>{var a=e.all||[],s=e.sending||[],n=e.failed||[],c=a.length,i=null;if(c){for(var l=0,u=null;l<c&&!u;){var d=e.all[l];(u=(0,x.denormalize)(d,C.messageSchema,{messages:r}))&&(u.type===o.MessageTypes.MSG_TYPE_SECURITY_TIPS||u.isFaking)&&(u=null),l++}u&&u.created_timestamp>Math.floor(t.last_message_time_nano/Math.pow(10,9))&&(i=(0,o.fillMessagePreview)(u))}if(!i){var{latest_message_id:S,latest_message_content:p,latest_message_type:_,last_message_option:E,latest_message_source:O,last_message_time_nano:T,latest_message_to_shop_id:g}=t;(i={id:S,content:p,type:_,message_option:E,source:O,to_shop_id:g}).created_at=new Date(T/1e6)+""}var{id:h,message_option:f}=i,v=s.includes(h)?o.MessageSendStatus.SENDING:n.includes(h)?o.MessageSendStatus.FAILED:i.send_status?o.MessageSendStatus.SUCCEED:null;return(0,o.hasTargetMessageOption)(f,o.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(v=o.MessageSendStatus.FAILED,i.type=it,i.content={text:ct("common.blacklist.replaced_text")}),(0,o.hasTargetMessageOption)(f,o.MessageOption.MSG_OPT_CANCELORDER_WARNING_NOT_SEND)&&(v=o.MessageSendStatus.FAILED),i.send_status=v,i},ut={MARK_AS_READ:"mark_as_read",MARK_AS_UNREAD:"mark_as_unread",DELETE_CONVERSATION:"delete_conversation",UPDATE_OFFER_STATUS:"update_offer_status",UPDATE_CONVERSATION:"update_conversation",UPDATE_USER_STATUS:"update_user_status",UPDATE_CONVERSATION_FLAG:"update_conversation_flag",FORCE_LOGOUT:"force_logout",UPDATE_RATING_CARD_STATUS:"update_rating_card_status",PULL_NOTIFICATION:"pull_notification",PIN_CONVERSATION:"pin_conversation",UNPIN_CONVERSATION:"unpin_conversation",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_PIN:"mass_pin",MASS_UNPIN:"mass_unpin",MASS_CLOSE:"mass_close",MASS_ACTIVATE:"mass_activate",VIDEO_UPLOAD:"video_upload",MARK_AS_REPLIED:"mark_as_replied",MARK_AS_UNREPLIED:"mark_as_unreplied",CHAT_DELETE_MSG:"chat_delete_msg",FAQ_SESSION_UPDATE:"faq_session_update",MUTE_CONVERSATION:"mute_conversation",UNMUTE_CONVERSATION:"unmute_conversation",CTT_UPDATE:"ctt_update",HAVE_UNRATED_CSAT:"have_unrated_csat"};!function(e){e.SHOW_LOADING_SUCCEEDED="SHOW_LOADING_SUCCEEDED",e.SET_HAS_SESSION="SET_HAS_SESSION",e.UPDATE_NETWORK_STATUS="UPDATE_NETWORK_STATUS",e.UPDATE_CUR_TAB_FOCUSED="UPDATE_CUR_TAB_FOCUSED",e.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED="UPDATE_CUR_TAB_FOCUSED_SUCCEEDED",e.UPDATE_WORKSTATION_PANEL="UPDATE_WORKSTATION_PANEL",e.UPDATE_NEW_MESSAGE_FLAG="UPDATE_NEW_MESSAGE_FLAG",e.UPDATE_CHAT_WINDOW_STATUS="UPDATE_CHAT_WINDOW_STATUS",e.UPDATE_CONVERSATION_DETAIL_STATUS="UPDATE_CONVERSATION_DETAIL_STATUS",e.UPDATE_LOGIN_SUCCESS_STATUS="UPDATE_LOGIN_SUCCESS_STATUS",e.UPDATE_CHAT_ENTRY_STATUS="UPDATE_CHAT_ENTRY_STATUS",e.LOGIN_REQUESTED="LOGIN_REQUESTED",e.LOGIN_SUCCEEDED="LOGIN_SUCCEEDED",e.LOGOUT_REQUESTED="LOGOUT_REQUESTED",e.LOGOUT_SUCCEEDED="LOGOUT_SUCCEEDED",e.UPDATE_LOGIN_STATUS="UPDATE_LOGIN_STATUS",e.SHOW_TRANSLATION_GUIDE="SHOW_TRANSLATION_GUIDE",e.SHOW_REGION_FILTER_GUIDE="SHOW_REGION_FILTER_GUIDE",e.FORCE_LOGOUT_REQUESTED="FORCE_LOGOUT_REQUESTED",e.CONNECT_SOCKET="CONNECT_SOCKET",e.UPLOAD_FEEDBACK_VIDEO_REQUESTED="UPLOAD_FEEDBACK_VIDEO_REQUESTED",e.UPLOAD_FEEDBACK_VIDEO_STATUS="UPLOAD_FEEDBACK_VIDEO_STATUS",e.UPDATE_RELATED_CAPACITY="UPDATE_RELATED_CAPACITY",e.UPDATE_IS_MAIN_PAGE="UPDATE_IS_MAIN_PAGE",e.UPDATE_SHOW_AUTO_HANGUP_MODAL="UPDATE_SHOW_AUTO_HANGUP_MODAL",e.UPDATE_HAS_FETCHED_UNREAD="UPDATE_HAS_FETCHED_UNREAD",e.CHECK_USER_PERMISSION_SUCCEEDED="CHECK_USER_PERMISSION_SUCCEEDED",e.SET_SERVICE_DOWN_STATUS="SET_SERVICE_DOWN_STATUS"}(nt||(nt={}));var{updateNetworkStatus:dt,updateShowAutoHangupModal:St,updateChatWindowStatus:pt,updateConversationDetailStatus:_t,updateLoginSuccessStatus:Et,updateChatEntryStatus:Ot,updateHasFetchedUnread:Tt}=(0,P.createActions)({[nt.UPDATE_NETWORK_STATUS]:({networkStatus:e})=>({networkStatus:e}),[nt.UPDATE_SHOW_AUTO_HANGUP_MODAL]:({showAutoHangupModal:e})=>({showAutoHangupModal:e}),[nt.UPDATE_CHAT_WINDOW_STATUS]:({showChatWindow:e})=>({showChatWindow:e}),[nt.UPDATE_CONVERSATION_DETAIL_STATUS]:({showConversationDetail:e})=>({showConversationDetail:e}),[nt.UPDATE_LOGIN_SUCCESS_STATUS]:({loginSuccess:e})=>({loginSuccess:e}),[nt.UPDATE_CHAT_ENTRY_STATUS]:({showEntry:e})=>({showEntry:e}),[nt.UPDATE_HAS_FETCHED_UNREAD]:({hasFetchedUnread:e})=>({hasFetchedUnread:e})});const gt={[nt.UPDATE_NETWORK_STATUS]:et(),[nt.UPDATE_SHOW_AUTO_HANGUP_MODAL]:et(),[nt.UPDATE_CHAT_WINDOW_STATUS]:et(),[nt.UPDATE_CONVERSATION_DETAIL_STATUS]:et(),[nt.UPDATE_LOGIN_SUCCESS_STATUS]:et(),[nt.UPDATE_CHAT_ENTRY_STATUS]:et(),[nt.UPDATE_HAS_FETCHED_UNREAD]:et()};var ht=r(672),ft=r(459),vt=r(598),At=r.n(vt);function yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{loginRequested:Ct,loginSucceeded:bt,logoutRequested:mt,logoutSucceeded:Rt,forceLogoutRequested:Pt}=(0,P.createActions)({[nt.LOGIN_REQUESTED]:()=>({}),[nt.LOGIN_SUCCEEDED]:({currentUserId:e,status:t})=>({currentUserId:e,status:t}),[nt.LOGOUT_REQUESTED]:()=>({}),[nt.LOGOUT_SUCCEEDED]:()=>({}),[nt.FORCE_LOGOUT_REQUESTED]:()=>({})});function*Ut(t){(yield(0,e.call)(o.getItem,t))||(yield(0,e.call)(o.setItem,t,(0,ft.v4)()))}function*wt(){var t=(0,o.getTranslationLocale)((0,o.getRuntimeLocale)()),r=yield(0,e.call)(C.getTranslation,{locale:t});yield(0,e.call)(o.changeLanguage,t,r)}var Nt=function*(t){var r,a,s=window.__CHATEASY_TRANSLATION__;if((0,o.checkEmptyObject)(s)||(0,o.checkEmptyObject)(s.collection)){var n=At().get("language");if(n)a=o.localeInMallToTspLocale[n]||"en";else{var c=o.defaultLocalInMall[(0,o.getRuntimeRegion)()]||"en";a=o.localeInMallToTspLocale[c]||"en"}(0,C.collectAsyncTask)(C.ReportPoint.TRANSLATION_IN_SERVICE,0)}else{(0,C.collectAsyncTask)(C.ReportPoint.TRANSLATION_IN_HTML,0);var i={};Object.keys(s.collection).forEach((e=>{i=Object.assign(i,s.collection[e])})),r=i,a=window.__CHATEASY_LOCALE__}if(!r)try{r=yield(0,e.call)(C.getTranslation,{locale:a})}catch(t){r=yield(0,e.call)(C.getTranslation,{locale:(0,o.getTranslationLocale)((0,o.getRuntimeLocale)())})}yield(0,e.call)(o.changeLanguage,a,r),yield(0,e.call)(o.updateTimeLocale,(0,o.getServiceLocale)(a))},It=function*(t){var r;yield(0,e.call)(wt),yield(0,e.put)(Ot({showEntry:!0})),yield(0,e.put)(Et({loginSuccess:!1})),(0,C.collectAsyncTask)(C.ReportPoint.LOGIN_FAILED,0,{type:(r=t,r instanceof C.InternalServerError?"InternalServerError":r instanceof C.Forbidden?"Forbidden":r instanceof C.Unauthoried?"Unauthoried":"Other")})};function*jt(t,r){try{var{godToken:a}=r,{user:s}=t,{id:n,type:c,locale:i,distribution_status:l}=s,u=c===o.AccountType.SUBACCOUNT;window.__WEBCHAT_LOGIN__||u&&"working"===l&&(window.__WEBCHAT_LOGIN__=!0),yield(0,e.call)(Nt,i||"en"),performance.mark("APP_RENDERING"),(0,C.collectLoadTask)(),(0,C.mdapConfig)(c),(0,C.configTrackerUser)(s),yield(0,e.put)(dt({networkStatus:"online"})),window.addEventListener("online",(()=>{ht.store.dispatch(dt({networkStatus:"online"}))})),window.addEventListener("offline",(()=>{ht.store.dispatch(dt({networkStatus:"offline"}))})),window.addEventListener("message",(e=>{var t;if("captcha-modal"===(null===(t=e.data)||void 0===t?void 0:t.type)){var r,a,s,n;if(3===(null===(r=e.data)||void 0===r?void 0:r.status)){var c,i,l,u=null===(c=e.data)||void 0===c?void 0:c.AC_CERT_D;u&&(0,o.isVisitingCn)()&&At().set("AC_CERT_D",u,{secure:!0,domain:"".concat(window.location.host),expires:new Date((new Date).getTime()+6e4)}),ht.store.dispatch(Io()),null===(i=(l=window).closeSFUCaptchaModal)||void 0===i||i.call(l)}1===(null===(a=e.data)||void 0===a?void 0:a.status)&&(ht.store.dispatch(wo()),null===(s=(n=window).closeSFUCaptchaModal)||void 0===s||s.call(n))}}),!1),yield(0,e.put)(Et({loginSuccess:!0})),yield(0,e.put)(Ot({showEntry:!0}));var{entities:d}=(0,C.normalize)("users",s);yield(0,e.put)(U({entities:d})),a||(yield(0,e.call)(Je.startConnect)),yield(0,e.put)(bt({currentUserId:n})),yield(0,e.call)(Xt),yield(0,e.spawn)(Ut,"device_id"),u||(yield(0,e.call)(Je.fetchShopSettings,{payload:{shopId:s.shop_id}}))}catch(t){yield(0,e.call)(It,t)}}function*Lt(){try{var t,r;performance.mark("APP_PREPARED");var a={};if(window.__WEBCHAT_SESSION__)(0,C.collectAsyncTask)(C.ReportPoint.LOGIN_IN_HTML,0),a=window.__WEBCHAT_SESSION__;else{(0,C.collectAsyncTask)(C.ReportPoint.LOGIN_IN_SERVICE,0);var s={method:"POST",subServer:"coreapi",resource:"login"},n=(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)();s.params={source:"pcmall"},n&&(s.parent="cbsc"),a=yield(0,e.call)(C.fetch,s)}return performance.mark("LOGIN_API_RESPONSED"),yield(0,o.setItem)("mini-session",a),o.LS.setItem("mini-session",JSON.stringify(a)),o.LS.setItem("chat-locale",JSON.stringify(null===(t=a)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.locale)),{session:a,params:{godToken:""}}}catch(t){yield(0,e.call)(It,t)}}function*Mt(){yield(0,e.takeLatest)(Ct,Lt),yield(0,e.takeLatest)(mt,er),yield(0,e.takeLatest)(Pt,$t)}const Ht={[nt.LOGIN_SUCCEEDED]:et(),[nt.LOGOUT_SUCCEEDED]:e=>Dt(Dt({},e),{},{currentUserId:null,performance:{},closeHangupTips:!1,hasVideoPermission:!1,captchaVisible:!1,curTabFocused:!0})};var{updateIsMainPage:kt,updateCurTabFocused:Ft,updateCurTabFocusedSucceeded:Gt}=(0,P.createActions)({[nt.UPDATE_IS_MAIN_PAGE]:({isMainPage:e})=>({isMainPage:e}),[nt.UPDATE_CUR_TAB_FOCUSED]:({focused:e})=>({focused:e}),[nt.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED]:({curTabFocused:e})=>({curTabFocused:e})});function*Vt({payload:{focused:t}}){t&&(yield(0,e.call)(Je.tabFocused),yield(0,e.put)(kt({isMainPage:!0}))),yield(0,e.put)(Gt({curTabFocused:t}))}function*Wt(){yield(0,e.takeEvery)(Ft,Vt)}const xt={[nt.UPDATE_IS_MAIN_PAGE]:et(),[nt.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED]:et()};var{setServiceDownStatus:Qt}=(0,P.createActions)({[nt.SET_SERVICE_DOWN_STATUS]:e=>e});window.addExternalGlobal("setServiceDownStatus",Qt);const qt={[nt.SET_SERVICE_DOWN_STATUS]:tt("serviceDownStatus")};function Bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{checkUserPermissionSucceeded:zt}=(0,P.createActions)({[nt.CHECK_USER_PERMISSION_SUCCEEDED]:({hasVideoPermission:e,hasReplyPermission:t,hasDeletePermission:r,deleteConfigDuration:o,deleteConfigVersion:a,waitingTimeFilter:s,subaccountHasUnrepliedPermission:n,showCrrDue:c,hideFeedback:i,chatbotToggle:l,showChatbotLoadingTime:u,disappearChatbotLoadingTime:d})=>({hasVideoPermission:e,hasReplyPermission:t,hasDeletePermission:r,deleteConfigDuration:o,deleteConfigVersion:a,waitingTimeFilter:s,subaccountHasUnrepliedPermission:n,showCrrDue:c,hideFeedback:i,chatbotToggle:l,showChatbotLoadingTime:u,disappearChatbotLoadingTime:d})}),Yt={hasVideoPermission:!1,hasReplyPermission:!1,hasDeletePermission:!1,deleteConfigDuration:0,deleteConfigVersion:0,waitingTimeFilter:!1,showCrrDue:!1,hideFeedback:!1,chatbotToggle:o.ChatbotToggle.Disable,showChatbotLoadingTime:0,disappearChatbotLoadingTime:0},Jt=()=>{try{return o.LS.getItem("minichat-service-down")||!1}catch(e){return!1}};function*Xt(){var t=yield(0,e.select)(de),{type:r,country:a}=t;try{var s,n,c,i=yield(0,e.call)(C.fetch,{subServer:"coreapi",parent:"user",resource:"global_config"}),{video:l,reply:u,waiting_time_filter:d,show_crr_due:S,delete_msg:p,support_subaccount_unreplied:_,hide_feedback:E,chatbot_toggle:O,show_chatbot_loading_time:T,disappear_chatbot_loading_time:g}=i||{},h=Kt(Kt({},Yt),{},{hasVideoPermission:l,hasReplyPermission:u,waitingTimeFilter:d,showCrrDue:S,hideFeedback:E,chatbotToggle:O,showChatbotLoadingTime:T,disappearChatbotLoadingTime:g});if(h.waitingTimeFilter=!1,h.chatbotToggle=o.ChatbotToggle.Disable,"seller"===r){var{config_version:f,region_config:v=[]}=p||{};h.deleteConfigVersion=f;var A=v.find((e=>e.region===a));A&&A.duration&&(h.hasDeletePermission=!0,h.deleteConfigDuration=A.duration)}else h.subaccountHasUnrepliedPermission=_;yield(0,e.put)(zt(Kt({},h))),void 0!==i.br_site_close&&(yield(0,e.put)(Qt({alert:(null==i||null===(s=i.br_site_close)||void 0===s?void 0:s.site_close)||!1,closed:Jt()})),window.__SERVICEDOWN_STATT_TIME__=(null==i||null===(n=i.br_site_close)||void 0===n?void 0:n.start_time)||0,window.__SERVICEDOWN_END_TIME__=(null==i||null===(c=i.br_site_close)||void 0===c?void 0:c.end_time)||0)}catch(t){yield(0,e.put)(zt(Kt({},Yt)))}}const Zt={[nt.CHECK_USER_PERMISSION_SUCCEEDED]:et()};var $t=function*(t=!0){t&&(yield(0,e.call)(Je.closeConnect)),yield(0,e.put)(Rt()),yield(0,e.put)(ao()),(0,o.removeItem)("mini-session"),(0,o.removeItem)("mini-sc_redirect")},er=function*(){try{var t={server:(0,o.getSCApiServer)(),namespace:"",resource:"logout/",params:{SPC_CDS:At().get("SPC_CDS"),SPC_CDS_VER:2}};(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)()?(t.version="cnsc",t.parent="selleraccount"):t.version="v1",yield(0,e.call)(C.fetch,t),document.location.replace("https://".concat((0,o.getSellerCenterUrl)(),"/account/signin")),window.removeEventListener("online",(()=>{ht.store.dispatch(dt({networkStatus:"online"}))})),window.removeEventListener("offline",(()=>{ht.store.dispatch(dt({networkStatus:"offline"}))})),(0,C.clearApiCache)(),yield(0,e.call)($t)}catch(t){t.handler?(0,e.call)(t.handler):console.error("[Logout Failed] ",t)}};function tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var or=[Mt,Wt],ar=(0,P.handleActions)(rr(rr(rr(rr(rr({},xt),Zt),gt),Ht),qt),{networkStatus:"online",currentUserId:null,currentUser:{},curTabFocused:!0,isMainPage:!0,subaccountHasUnrepliedPermission:!1,showAutoHangupModal:!1,hasVideoPermission:!1,hasReplyPermission:!1,shouldInitFSSDK:!1,hasDeletePermission:!1,deleteConfigVersion:0,deleteConfigDuration:0,waitingTimeFilter:!1,showCrrDue:!1,hideFeedback:!1,showChatbotLoadingTime:0,disappearChatbotLoadingTime:0,loginSuccess:!0,showChatWindow:!1,showConversationDetail:!0,showEntry:!1,hasFetchedUnread:!1,serviceDownStatus:{alert:!1,closed:!1,list:!1,message:!1}}),sr=e=>(0,t.createSelector)(T,(t=>(0,x.denormalize)(e,C.shopSchema,{shops:t}))),nr=e=>{var t;return(null==e||null===(t=e.shopReducer)||void 0===t?void 0:t.fetchedShopIds)||[]},cr=e=>new Promise((t=>{(0,C.fetch)({parent:"conversation",resource:"unread-counts",params:{shop_ids:JSON.stringify(e)}}).then((({"unread-counts":e=[]})=>{t(e)})).catch((()=>{t([])}))}));function*ir({payload:{shopId:t}}){try{var r=yield(0,e.select)(sr(t));r=yield(0,e.call)(C.fetch,{resource:"shop",id:t,params:{need_cache:1,cache_expires:600}});var{entities:o}=(0,C.normalize)("shops",r);return yield(0,e.put)(U({entities:o})),yield(0,e.put)((0,Je.updateFetchedShopIds)({shopIds:[r.id]})),r}catch(e){return{}}}var lr=({shopIds:e})=>{var t={ids:JSON.stringify(e)};return new Promise((e=>{(0,C.fetch)({resource:"shop_list",params:t}).then((({shops:t=[]})=>{e(t)})).catch((()=>{e([])}))}))};function*ur({payload:{shopId:t}}){try{return yield(0,e.call)(C.fetch,{parent:"shop",parentId:t,resource:"auth"})}catch(e){return{}}}var dr,Sr=e=>e.toastReducer.toast,pr=r(701).t,_r=(e,t)=>{var r={};if(t){switch(t.type){case"auto-reply":e?t.first&&"enabled"===t.action?(r.message=pr("settings.enable_auto_reply_successfully"),r.show=!0):(r.message="",r.show=!1):(t.first&&"enabled"===t.action?r.message=pr("settings.failed_to_enable_auto_reply"):r.message="enabled"===t.action?pr("settings.failed_to_enable"):pr("settings.failed_to_disable"),r.show=!0);break;case"message":r.message=e?"save"===t.action?pr("settings.message.save_successfully"):"delete"===t.action?pr("settings.message.delete_successfully"):pr("settings.message.import_successfully"):"save"===t.action?pr("settings.message.failed_to_save"):"delete"===t.action?pr("settings.message.failed_to_delete"):pr("settings.message.failed_to_import"),r.show=!0;break;case"message-tips":e?(r.message="",r.show=!1):(r.message="enabled"===t.action?pr("settings.failed_to_enable"):pr("settings.failed_to_disable"),r.show=!0);break;case"forward":e||(r.message=403===t.status?pr("forward.exception",{forwardName:""}):pr("forward.server_error"),r.show=!0);break;case"send-feedback":r.message=pr("feedback_modal.error.failed_to_send"),r.show=!0;break;case"server-error-tips":r.message=pr("common.server_error.warning_tips"),r.show=!0;break;case"conversation-closed-tip":r.message=pr("conversation_detail.closed.warning_tips"),r.show=!0;break;case"permission-denied":r.message=pr("common.permission_denied"),r.show=!0;break;case"claim-voucher":r.message=pr(e?"voucher.claim.success":"voucher.claim.fail"),r.show=!0;break;case"claim-voucher-not-satisfy":r.message=pr("voucher.claim.fail_not_satisfy_rule"),r.show=!0;break;case"claim-voucher-already-claimed":r.message=pr("voucher.claim.fail_already_claimed"),r.show=!0;break;case"private-image":r.message=pr("common.image.expired"),r.show=!0;break;case"operation":"save"===t.action&&(r.message=pr(e?"text.save_successfully":"text.save_failed")),r.show=!0;break;default:r.message=t.message,r.show=!0}r.type=e?"success":"fail"}return r};!function(e){e.COPY_SUCCEED_FEEDBACK="COPY_SUCCEED_FEEDBACK",e.SET_TOAST_INFORMATION="SET_TOAST_INFORMATION",e.SET_TOAST_INFORMATION_SUCCEEDED="SET_TOAST_INFORMATION_SUCCEEDED"}(dr||(dr={}));var{copySucceedFeedback:Er,setToastInformation:Or,setToastInformationSucceeded:Tr}=(0,P.createActions)({[dr.COPY_SUCCEED_FEEDBACK]:()=>({}),[dr.SET_TOAST_INFORMATION]:({type:e,error:t,toast:r})=>({type:e,error:t,toast:r}),[dr.SET_TOAST_INFORMATION_SUCCEEDED]:({toast:e})=>({toast:e})});function*gr({payload:{type:t,error:r,toast:o}}){if(yield(0,e.select)(De)){var a=null;t&&(a=_r(!1,{type:t})),void 0!==r&&(a=r instanceof C.CustomError||r instanceof C.Webview?r.handler():_r(!1,{type:"server-error-tips"})),o&&(a=o),yield(0,e.put)(Tr({toast:a}))}}const hr={[dr.SET_TOAST_INFORMATION_SUCCEEDED]:et()};var fr=r(701).t;function*vr(){yield(0,e.put)(Or({toast:_r(!0,{message:fr("common.successful_copied")})}))}function Ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var yr,Dr=[function*(){yield(0,e.takeEvery)(Or,gr)},function*(){yield(0,e.takeEvery)(Er,vr)}],Cr=(0,P.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},hr),{toast:{type:"",message:"",show:!1}}),br=e=>e.messageShortcutGroupReducer||{groups:[],status:"",currentGroupType:-1,currentGroupId:-1},mr=(0,t.createSelector)(br,(e=>e.status)),Rr=(0,t.createSelector)(br,(e=>e.currentGroupType)),Pr=(0,t.createSelector)(br,(e=>e.currentGroupId)),Ur=(0,t.createSelector)(br,(e=>e.groups)),wr=(0,t.createSelector)(Ur,(e=>e.filter((e=>e.group_type===o.MessageShortcutGroupType.PERSONAL)))),Nr=(0,t.createSelector)(Ur,(e=>e.filter((e=>e.group_type===o.MessageShortcutGroupType.TEAM)))),Ir=(0,t.createSelector)(Ur,Rr,((e,t)=>-1===t?e:e.filter((e=>e.group_type===t)))),jr=(0,t.createSelector)(wr,(e=>e.reduce(((e,t)=>{var{message_shortcuts:r=[]}=t;return e.concat(r)}),[]))),Lr=(0,t.createSelector)(Nr,(e=>e.reduce(((e,t)=>{var{message_shortcuts:r=[]}=t;return e.concat(r)}),[]))),Mr=(0,t.createSelector)(jr,Lr,((e=[],t=[])=>[...e,...t])),Hr=(0,t.createSelector)(Mr,(e=>[...e.filter((e=>!(null==e||!e.pin_time))).sort(((e,t)=>e.pin_time-t.pin_time)),...e.filter((e=>!(null!=e&&e.pin_time)))])),kr=(0,t.createSelector)(Hr,Rr,Pr,((e,t,r)=>{var o=-1===t?e:e.filter((e=>e.group_type===t));return-1===r?o:o.filter((e=>e.groupId===r))})),Fr=e=>{var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.settings)||{}},Gr=e=>{var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.needForceUpdate)||!1},Vr=e=>{var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.status)||""},Wr=e=>{var t;return(null==e||null===(t=e.settingsReducer)||void 0===t?void 0:t.fetchStatus)||""},xr=(0,t.createSelector)(Fr,(e=>e.auto_translation_status||"")),Qr=(0,t.createSelector)(Fr,(e=>e.message_shortcuts_status||"")),qr=(0,t.createSelector)(Fr,(e=>e.legacy_message_shortcuts_count||0)),Br=(0,t.createSelector)(Fr,(e=>e.distribution_account_status||"enabled")),Kr=(0,t.createSelector)(Fr,(e=>e.display_banner||!1));function*zr(){try{yield(0,e.put)((0,Je.fetchSettingsStatus)({fetchStatus:o.DataFetchStatus.PENDING}));var t=yield(0,e.call)(C.fetch,{parent:"user",resource:"setting"});return yield(0,e.put)((0,Je.fetchSettingsSucceeded)({settings:t,fetchStatus:o.DataFetchStatus.SUCCEED,timestamp:Date.now(),needForceUpdate:!1})),t}catch(t){return yield(0,e.put)((0,Je.fetchSettingsStatus)({fetchStatus:o.DataFetchStatus.FAILED})),{}}}!function(e){e.HANDLE_401_ERROR_REQUESTED="HANDLE_401_ERROR_REQUESTED",e.UPDATE_CONVERSATION_LISTS_HASH="UPDATE_CONVERSATION_LISTS_HASH",e.OPEN_MALL_URL="OPEN_MALL_URL"}(yr||(yr={}));var{openMallUrl:Yr}=(0,P.createActions)({[yr.OPEN_MALL_URL]:({path:e,region:t})=>({path:e,region:t})}),Jr="xiapibuy.com";function*Xr({payload:{path:t="",region:r=""}}){var a,s=r?r.toLowerCase():(0,o.getRuntimeRegion)();"cn"!==s&&"kr"!==s||(s="my");var n=t?t.startsWith("/")?t:"/".concat(t):"";if((0,o.isVisitingCn)())try{var{data:c}=yield(0,e.call)(C.fetch,{url:"https://".concat((0,o.getSCApiServer)(),"/selleraccount/nonce/get/")}),i="".concat((0,o.cnDomainHash)(s),".").concat((0,o.envPrefix)()).concat(Jr),l=encodeURIComponent(window.btoa('{"next":"https://'.concat(i).concat(n,'"}')));n="/api/seller_platform/nonce/callback/?nonce=".concat(c.nonce,"&region=").concat(s,"&state=").concat(l),a="https://".concat(i).concat(n)}catch(e){a="https://".concat((0,o.cnDomainHash)(s),".").concat((0,o.envPrefix)()).concat(Jr).concat(n)}else a="https://".concat((0,o.domainPrefix)(),".").concat((0,o.domainSuffix)(s)).concat(n);window.open(a)}var{handle401ErrorRequested:Zr}=(0,P.createActions)({[yr.HANDLE_401_ERROR_REQUESTED]:({resource:e})=>({resource:e})}),{updateConversationListsHash:$r}=(0,P.createActions)({[yr.UPDATE_CONVERSATION_LISTS_HASH]:()=>({})}),eo=[function*(){yield(0,e.takeEvery)(Yr,Xr)}],to=(0,t.createSelector)(s,(e=>e.offers||{})),ro=(e,r,a,s)=>(0,t.createSelector)(to,(t=>Object.values(t).filter((t=>t.product_id===s&&t.model_id===r&&t.conversation_id===e&&t.id!==a&&t.status===o.OfferStatus.PENDING)))),oo=e=>(0,t.createSelector)(s,(t=>(0,x.denormalize)(e,C.offerSchema,t))),{reduxReset:ao}=(0,P.createActions)({REDUX_RESET:()=>({})});window.addExternalGlobal("resetAction",ao);var so=e=>{var t;return(null===(t=e.draftReducer)||void 0===t?void 0:t.draftHash)||{}},no=e=>(0,t.createSelector)(so,(t=>t[e]||"")),co=e=>{var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.translationSettings)||{}},io=e=>{var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.fetchSettingsStatus)||""},lo=e=>{var t;return(null==e||null===(t=e.translatePreferenceReducer)||void 0===t?void 0:t.updateStatus)||""};function uo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function So(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?uo(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function*po(t,r,o,a=[]){var s=t,n=[],c=[];Array.isArray(t)&&(s=((0,C.normalize)(o,t).entities||{})[o]||{}),r.forEach((t=>{var r=t.id,i=s[r];i?["conversations","agentConversations"].includes(o)&&(void 0!==i.faking||i.latestMessageStatus||void 0!==i.unreplied)?(delete(t=So(So({},i),t)).faking,delete t.latestMessageStatus,delete t.unreplied,c.push(t)):(a.length&&a.forEach((e=>{t[e]=i[e]})),n.push((0,e.put)(w({name:o,id:r,record:So({},t)})))):c.push(t)})),c.length&&n.push((0,e.put)(U({entities:(0,C.normalize)(o,c).entities}))),yield(0,e.all)(n)}var _o,Eo=e=>(0,t.createSelector)(S,(t=>(0,x.denormalize)(e,[C.productSchema],{products:t}))),Oo=e=>e.reportReducer.beingReported;!function(e){e.REPORT_REQUESTED="REPORT_REQUESTED",e.CLEAR_REPORT_REQUESTED="CLEAR_REPORT_REQUESTED"}(_o||(_o={}));var{reportRequested:To,clearReportRequested:go}=(0,P.createActions)({[_o.REPORT_REQUESTED]:({event_time:e,url:t})=>({event_time:e,url:t}),[_o.CLEAR_REPORT_REQUESTED]:()=>({})});function ho(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function fo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ho(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ho(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function*vo(){var t=yield(0,e.select)(Oo);if(t.length){var r=[...t];yield(0,e.put)(go()),r.sort(((e,t)=>Number(t.event_time)-Number(e.event_time))),yield(0,e.call)(C.fetch,{method:"POST",subServer:"coreapi",parent:"user",resource:"report_active",payload:JSON.stringify(fo(fo({},r[0]),{},{platform_id:(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)()?2:1}))})}}const Ao={[_o.REPORT_REQUESTED]:(e,{payload:{event_time:t,url:r}})=>({beingReported:[...e.beingReported,{event_time:t,url:r}]}),[_o.CLEAR_REPORT_REQUESTED]:e=>({beingReported:[]})};function yo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var Do,Co=[function*(){for(;;)yield(0,e.delay)(6e4),yield vo()}],bo=(0,P.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Ao),{beingReported:[]});function mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.ADD_NEED_CAPTCHA_REQUEST="ADD_NEED_CAPTCHA_REQUEST",e.DELETE_CAPTCHA_REQUEST="DELETE_CAPTCHA_REQUEST",e.CLEAR_NEED_CAPTCHA_REQUEST="CLEAR_NEED_CAPTCHA_REQUEST",e.RESEND_NEED_CAPTCHA_REQUEST="RESEND_NEED_CAPTCHA_REQUEST"}(Do||(Do={}));const Po={[Do.ADD_NEED_CAPTCHA_REQUEST]:(e,{payload:{request:t}})=>{var r=[...e.verifyRequests];return r.push(t),Ro(Ro({},e),{},{verifyRequests:r})},[Do.DELETE_CAPTCHA_REQUEST]:e=>{var t=[...e.verifyRequests];return t.pop(),Ro(Ro({},e),{},{verifyRequests:t})},[Do.CLEAR_NEED_CAPTCHA_REQUEST]:e=>Ro(Ro({},e),{},{verifyRequests:[]})};var{addNeedCaptchaRequest:Uo,deleteCaptchaRequest:wo,clearNeedCaptchaRequest:No,resendNeedCaptchaRequest:Io}=(0,P.createActions)({[Do.ADD_NEED_CAPTCHA_REQUEST]:({request:e})=>({request:e}),[Do.DELETE_CAPTCHA_REQUEST]:()=>({}),[Do.CLEAR_NEED_CAPTCHA_REQUEST]:()=>({}),[Do.RESEND_NEED_CAPTCHA_REQUEST]:()=>({})});function*jo(){try{var t=yield(0,e.select)(ko);if(t.length)for(var r of(yield(0,e.put)(No()),t)){var{id:o,extra:a}=r;switch(o){case"unread-count":yield(0,e.spawn)(Je.doRefreshTotalUnreadConversationsCount,a);break;case"unread-count-single":yield(0,e.spawn)(doRefreshSingleShopUnreadConversationCount,a);break;case"send-message":yield(0,e.put)((0,Je.resendMessageRequested)(a));break;case"item-list-my-shop":case"item-list-other-shop":yield(0,e.put)((0,Je.fetchProductsRequested)(a));break;case"fill-handler":yield(0,e.call)(Je.fillActionHandler,a)}}}catch(e){}}function Lo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var Mo=(0,P.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Po),{verifyRequests:[]}),Ho=[function*(){yield(0,e.takeEvery)(Io,jo)}],ko=e=>e.captchaVerifyReducer.verifyRequests;function*Fo(t,r,o){yield(0,e.takeEvery)(t,(function*(t){var a=t.payload.id;a?yield(0,e.race)({task:(0,e.call)(r,t),cancel:(0,e.take)((e=>e.type===o.toString()&&e.payload.id===a))}):yield(0,e.call)(r,t)}))}})(),_})())},53402:function(e,t,r){"use strict";e.exports=r(25061)}}]);