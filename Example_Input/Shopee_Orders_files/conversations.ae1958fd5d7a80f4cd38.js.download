(self.miniJsonp=self.miniJsonp||[]).push([[4997],{55698:function(e,n,r){var t,o,c,u,i;e.exports=(t=r(82677),o=r(20573),c=r(53402),u=r(96961),i=r(29494),function(){"use strict";var e={383:function(e){e.exports=t},975:function(e){e.exports=o},511:function(e){e.exports=c},644:function(e){e.exports=u},855:function(e){e.exports=i}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var c=n[t]={exports:{}};return e[t](c,c.exports,r),c.exports}r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return function(){function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function n(n,r){if(n){if("string"==typeof n)return e(n,r);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?e(n,r):void 0}}function t(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,o,c=[],u=!0,i=!1;try{for(r=r.call(e);!(u=(t=r.next()).done)&&(c.push(t.value),!n||c.length!==n);u=!0);}catch(e){i=!0,o=e}finally{try{u||null==r.return||r.return()}finally{if(i)throw o}}return c}}(e,r)||n(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.r(s),r.d(s,{allConversationIdsSelector:function(){return d},conversationBeenDeletedSelector:function(){return Q},conversationDirectionSelector:function(){return y},conversationHttpStatusSelector:function(){return h},conversationIdsSelector:function(){return a},conversationLastMessageSelector:function(){return ze},conversationsSelector:function(){return _},curConvsMessageSelector:function(){return Ve},curMessagesRelatedSelector:function(){return we},currentBuyerIdSelector:function(){return P},currentBuyerSelector:function(){return G},currentBuyerShopIdSelector:function(){return V},currentBuyerShopSelector:function(){return F},currentConversationBuyerIdSelectors:function(){return L},currentConversationCanReadSelector:function(){return m},currentConversationHasLoadingSelector:function(){return fe},currentConversationIdSelector:function(){return g},currentConversationMaxOptionHideTimeSelectors:function(){return k},currentConversationSelector:function(){return A},currentConversationShopIdSelectors:function(){return z},currentConversationShopRegionSelectors:function(){return j},currentConversationShopSelectors:function(){return w},currentConversationStatusSelectors:function(){return D},currentConversationToNameSelector:function(){return $},currentConversationTranslationAccessSelector:function(){return K},currentPendingOffersCountSelector:function(){return re},currentSellerAccountIdSelector:function(){return ce},currentShopIdSelector:function(){return U},degradeConversationIdsSelector:function(){return O},feedbackSelector:function(){return Ke},filterSelector:function(){return I},filteredConversationsSelector:function(){return T},getConversation:function(){return x},getConversationPendingOffersCountSelector:function(){return te},getConversationShopId:function(){return B},getConversationShopRegion:function(){return oe},getConversations:function(){return N},getConvsMessagesRelatedSelector:function(){return je},getMessageSelector:function(){return Pe},inlocationSelector:function(){return S},isNavigateToUnreadMessageSelector:function(){return Z},keywordSelector:function(){return H},listsHashSelector:function(){return q},mediaListSelector:function(){return Je},messagesRelatedMapSelector:function(){return Ie},missedReadNoticeCountSelector:function(){return v},navigateToUnreadMessageIdSelector:function(){return ee},noticesCountSelector:function(){return Qe},pinnedConversationIdsSelector:function(){return l},readRequestIdsSelector:function(){return f},reconnectFlagSelector:function(){return qe},replyToMessageSelector:function(){return Ye},resultsSelector:function(){return Y},reverseMessagesSelector:function(){return Be},searchConversationHttpStatusSelector:function(){return J},selectVideoInfoByKey:function(){return Ee},selectVideoInfoKeyByVid:function(){return Ae},shopAccessSelector:function(){return X},showFrozenTipSelector:function(){return le},showLoadingMessagesMapSelector:function(){return de},singleConversationMarkInfoSelector:function(){return ae},sortedConversationsSelector:function(){return E},totalConversationsCountSelector:function(){return ie},updateTimeNowSelector:function(){return p}});var o=r(383),c=r(975),u=r(511),i=r(644),a=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.conversationIds)||[]},l=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.pinnedConversationIds)||[]},d=(0,c.createSelector)(a,l,(function(e,n){var r=e.filter((function(e){return!n.includes(e)}));return n.concat(r)})),f=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.readRequestIds)||[]},v=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.missedReadNoticeCount)||0},S=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.inlocation)||!1},p=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.updateTimeNow)||"0"},g=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.currentConversationId)||null},m=function(e){var n;return(0,u.judgeUndefined)({defaultValue:!0,value:null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.currentConversationCanRead})},h=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.status)||""},y=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.direction)||""},_=(0,c.createSelector)(u.conversationEntitiesSelector,d,(function(e,n){return((0,o.denormalize)(n,[i.conversationSchema],{conversations:e})||[]).filter(Boolean)})),C=(0,c.createSelector)(_,g,(function(e,n){return e.filter((function(e){var r=e.id,t=e.unread_count;return e&&(t>0||r===n)}))})),b=(0,c.createSelector)(_,(function(e){return e.filter((function(e){return e.isPinned}))})),M=(0,c.createSelector)(_,(function(e){return e.filter((function(e){return e.status&&"closed"===e.status}))})),R=(0,c.createSelector)(_,g,(function(e,n){return e.filter((function(e){var r=e.unreplied,t=e.id;return void 0===r||r||!r&&t===n}))})),O=(0,c.createSelector)(_,(function(e){return e.filter((function(e){return e.lack})).map((function(e){return e.id}))||[]})),I=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.filter)||"All"},T=(0,c.createSelector)(I,_,C,b,M,R,(function(e,n,r,t,o,c){return{All:n,Unread:r,Pinned:t,Closed:o,Unreplied:c}[e]})),E=(0,c.createSelector)(T,l,u.waitingTimeFilterSelector,I,(function(e,n,r,t){var o=e.filter((function(e){return!n.includes(e.id)})),c=e.filter((function(e){return n.includes(e.id)}));return o.sort((function(e,n){return parseInt(n.latest_message_id)-parseInt(e.latest_message_id)})),c.concat(o).filter((function(e){return void 0===e.faking}))})),A=(0,c.createSelector)(_,g,u.isSubAccountSelector,S,u.userEntitiesSelector,u.conversationEntitiesSelector,(function(e,n,r,t,c,u){var s=e.find((function(e){return e.id===n}))||{};if(t&&!s.id&&(s=(0,o.denormalize)(n,i.conversationSchema,{conversations:u})||{}),!r&&s.lack){var a=s.to_id,l=(0,o.denormalize)(a,i.userSchema,{users:c})||{},d={to_shop_id:l.shop_id,to_status:l.status,to_name:l.name||"-",to_avatar:l.avatar};return Object.assign(s,d)}return s})),P=(0,c.createSelector)(A,(function(e){return(e||{}).to_id||null})),w=(0,c.createSelector)(A,u.shopsEntitiesSelector,(function(e,n){return(0,o.denormalize)(e.shop_id,i.shopSchema,{shops:n})||{}})),j=(0,c.createSelector)(w,(function(e){return(null==e?void 0:e.country)||"SG"})),z=(0,c.createSelector)(A,(function(e){return e.shop_id})),L=(0,c.createSelector)(A,(function(e){return e.to_id})),D=(0,c.createSelector)(A,(function(e){return e.status})),k=(0,c.createSelector)(A,(function(e){return e.max_general_option_hide_time})),x=function(e){return(0,c.createSelector)(u.conversationEntitiesSelector,(function(n){return(0,o.denormalize)(e,i.conversationSchema,{conversations:n})||{}}))},B=function(e){return(0,c.createSelector)(x(e),(function(e){return e.shop_id}))},N=function(e){return(0,c.createSelector)(_,(function(n){return e.map((function(e){return n.find((function(n){return n.id===e}))})).filter(Boolean)}))},U=(0,c.createSelector)(A,(function(e){return(e||{}).shop_id||null})),G=(0,c.createSelector)(u.userEntitiesSelector,A,(function(e,n){return n?(0,o.denormalize)(n.to_id,i.userSchema,{users:e}):{}})),V=(0,c.createSelector)(A,(function(e){return(e||{}).to_shop_id||null})),F=(0,c.createSelector)(V,u.shopsEntitiesSelector,(function(e,n){return(0,o.denormalize)(e,i.shopSchema,{shops:n})||{}})),H=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.keyword)||""},Y=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.results)||[]},J=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.searchStatus)||""},K=(0,c.createSelector)(A,(function(e){return e.translationAccess})),q=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.listsHash)||{}},Q=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.conversationBeenDeleted)||!1},$=(0,c.createSelector)(A,(function(e){return(e||{}).to_name})),W={hasSCAccess:!0,hasEditOrderAccess:!0,hasViewOrderAccess:!0,hasViewProductAccess:!0,hasEditVoucherAccess:!0,hasViewVoucherAccess:!0,hasViewRrOrderAccess:!0,hasOrderDetailAccess:!0},X=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.access)||W},Z=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.isNavigateToUnreadMessage)||!1},ee=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.navigateToUnreadMessageId)||""},ne=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.pendingOffersCount)||{}},re=(0,c.createSelector)(A,ne,(function(e,n){var r=e.shop_id,t=e.to_id;return n["".concat(r,"_").concat(t)]||0})),te=function(e){return(0,c.createSelector)(x(e),ne,(function(e,n){var r=e.shop_id,t=e.to_id;return n["".concat(r,"_").concat(t)]||0}))},oe=function(e){return(0,c.createSelector)(B(e),u.shopsEntitiesSelector,(function(e,n){var r=(0,o.denormalize)(e,i.shopSchema,{shops:n})||{};return(null==r?void 0:r.country)||"SG"}))},ce=(0,c.createSelector)(u.isSubAccountSelector,u.currentUserIdSelector,w,(function(e,n,r){return e?r.user_id:n})),ue={unrepliedCount:0,duesoonCount:0,overdueCount:0,pinnedCount:0,unreadCount:0},ie=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.totalConversationsCount)||ue},se=function(e){var n;return(null==e||null===(n=e.conversationReducer)||void 0===n?void 0:n.conversationMark)||{}},ae=function(e){return(0,c.createSelector)(se,(function(n){return n[e]}))},le=(0,c.createSelector)(u.shopTranslationSettingsSelector,u.isSubAccountSelector,U,u.currentUserShopIdSelector,(function(e,n,r,t){return"frozen"===(e[n?r:t]||{}).userStatus})),de=function(e){var n;return null===(n=e.conversationReducer)||void 0===n?void 0:n.showLoadingMessagesMap},fe=(0,c.createSelector)(g,de,(function(e,n){var r=n&&n[e];return(Object.entries(r||{})||[]).some((function(e){var n=t(e,2),r=(n[0],n[1]);return null==r?void 0:r.showLoading}))}));function ve(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Se(r){return function(n){if(Array.isArray(n))return e(n)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||n(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var pe=r(855);function ge(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function me(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ge(Object(r),!0).forEach((function(n){ve(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var he,ye=pe.MessageTypes.MSG_TYPE_OFFER,_e=pe.MessageTypes.MSG_TYPE_ORDER,Ce=pe.MessageTypes.MSG_TYPE_PRODUCT,be=pe.MessageTypes.MSG_TYPE_FAQ_UNSUPPORTED,Me=pe.MessageTypes.MSG_TYPE_FAQ_LIVEAGENT_PROMPT,Re=pe.MessageTypes.MSG_TYPE_RATE_CARD,Oe=[_e,Ce],Ie=(0,c.createSelector)((function(e){return e}),(function(e){return(e.messageReducer||{}).messagesRelatedMap||{}})),Te=function(e){var n;return(null===(n=e.messageReducer)||void 0===n?void 0:n.videoMap)||{}},Ee=function(e){return(0,c.createSelector)(Te,(function(n){return JSON.parse(JSON.stringify(n[e]||{}))}))},Ae=function(e){return(0,c.createSelector)(Te,(function(n){return Object.keys(n).find((function(r){return n[r].vid===e}))}))},Pe=function(e){return(0,c.createSelector)(u.messageEntitiesSelector,(function(n){return(0,o.denormalize)(e,i.messageSchema,{messages:n})}))},we=(0,c.createSelector)(g,Ie,(function(e,n){return n[e]||{all:[]}})),je=function(e){return(0,c.createSelector)(Ie,(function(n){return n[e]||{all:[],sending:[],failed:[]}}))},ze=(he=function(e){return(0,c.createSelector)(je(e),x(e),u.messageEntitiesSelector,(function(e,n,r){return(0,u.getConversationLastMessage)(e,n,r)}))},function(){var e=Array.prototype.slice.call(arguments);return he.memoize=he.memoize||{},e in he.memoize?he.memoize[e]:he.memoize[e]=he.apply(this,e)}),Le=(0,c.createSelector)(we,(function(e){var n=Se(e.all||[]);return e.securityTipsMessageId&&n.push(e.securityTipsMessageId),n})),De=(0,c.createSelector)(we,(function(e){return e.sending||[]})),ke=(0,c.createSelector)(we,(function(e){return e.failed||[]})),xe=(0,c.createSelector)(u.messageEntitiesSelector,Le,(function(e,n){return((0,o.denormalize)(n,[i.messageSchema],{messages:e})||[]).filter(Boolean)})),Be=(0,c.createSelector)(xe,(function(e){return e.reverse()})),Ne=(0,c.createSelector)(A,Be,(function(e,n){return e?n.filter(Boolean).reduce((function(e,n){var r=n.type,t=n.source_type,o=n.source_content,c=n.content;if(!t||r===ye||[-1,0].includes(o["".concat(t,"_id")]))return e;if(Oe.includes(r)&&o){var u="".concat(r,"_id");if(c[u]===o[u])return e}var i=e.lastSourceMessage,s=e.sourceList;if(!s.length)return{sourceList:s.concat(n),lastSourceMessage:n};if(t===Ce){var a=null==o?void 0:o.product_id,l=i.source_content&&i.source_content.product_id;if(!a||l===a)return e}else if(t===_e){var d=null==o?void 0:o.order_id,f=i.source_content&&i.source_content.order_id;if(!d||[-1,0,f].includes(d))return e}return{sourceList:s.concat(n),lastSourceMessage:n}}),{sourceList:[],lastSourceMessage:null}).sourceList:[]})),Ue=(0,c.createSelector)(Ne,(function(e){return e.map((function(e){return e.id}))})),Ge=(0,c.createSelector)(u.entitiesSelector,xe,(function(e,n){var r=n.filter((function(e){return e&&e.type===ye})).map((function(e){return e.content.offer_id}));return(0,o.denormalize)(r,[i.offerSchema],e)})),Ve=(0,c.createSelector)(Be,Ue,De,ke,A,u.rateCardEntitiesSelector,Ge,(function(e,n,r,t,o,c,u){return o?e.filter((function(e){if(!e)return!1;var n=e.content,r=e.type;return!(![be,Me].includes(r)&&(!n||n&&0===Object.keys(n).length))})).map((function(e){var o=r.includes(e.id)?pe.MessageSendStatus.SENDING:t.includes(e.id)?pe.MessageSendStatus.FAILED:e.send_status?pe.MessageSendStatus.SUCCEED:null,i=n.includes(e.id),s=Object.assign({},e,{send_status:o,hasMessageSource:i}),a=s,l=a.type,d=a.content,f=void 0===d?{}:d,v=a.message_option;switch(l){case ye:var S=u.find((function(e){return e&&e.id===f.offer_id}));s=Object.assign({},s,{textContent:S});break;case Re:var p=c[f.card_id];p&&(s=Object.assign({},s,{textContent:p}))}return(0,pe.hasTargetMessageOption)(v,pe.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(s=me(me({},s),{},{send_status:pe.MessageSendStatus.FAILED,errorCode:pe.MessageErrorCode.BLACKLIST})),s})):[]})),Fe=(0,c.createSelector)((function(e){var n;return null==e||null===(n=e.messageReducer)||void 0===n?void 0:n.reply}),(function(e){return e?e.toMessageId:{}})),He=(0,c.createSelector)(g,Fe,(function(e,n){return n[e]||""})),Ye=(0,c.createSelector)(He,u.messageEntitiesSelector,(function(e,n){return(0,o.denormalize)(e,i.messageSchema,{messages:n})})),Je=(0,c.createSelector)(g,(function(e){var n;return(null===(n=e.mediaPreviewerReducer)||void 0===n?void 0:n.mediaMap)||{}}),(function(e,n){return n[e]||[]})),Ke=function(e){var n;return(null==e||null===(n=e.socketReducer)||void 0===n?void 0:n.feedback)||void 0},qe=function(e){var n;return(null==e||null===(n=e.socketReducer)||void 0===n?void 0:n.reconnectFlag)||!1},Qe=function(e){var n;return(null==e||null===(n=e.socketReducer)||void 0===n?void 0:n.noticesCount)||0}}(),s}())},66633:function(e,n,r){"use strict";e.exports=r(55698)}}]);